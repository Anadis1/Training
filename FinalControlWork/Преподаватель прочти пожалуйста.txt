SQL не моя сильная сторона и по этому я пользовался помощью интернета, на анализ и понимание у меня ушло 4 часа, не судите строго.
Надеюсь вам понравится моя программа на паитон.